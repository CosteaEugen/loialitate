<!DOCTYPE html>
<html>
<head>
  <title>Scanare cod QR</title>
  <style>
    /* Add any CSS styles you want here */
  </style>
</head>
<body>
  <div class="container">
    <h1>Scanare cod QR</h1>
    <p>Folosește camera dispozitivului tău pentru a scana un cod QR.</p>
    <video id="qrVideo" playsinline autoplay></video>
    <canvas id="qrCanvas" style="display: none;"></canvas>
    <button id="scanButton">Începe scanarea</button>
    <div id="qrResult" style="margin-top: 10px;"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/quagga/0.12.1/quagga.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const scanButton = document.getElementById("scanButton");
      const qrResultDiv = document.getElementById("qrResult");
      const video = document.getElementById("qrVideo");
      const canvas = document.getElementById("qrCanvas");
      const canvasContext = canvas.getContext("2d");

      // Function to display the scan result
      function displayScanResult(result) {
        qrResultDiv.innerHTML = `
          <p>Cod QR scanat:</p>
          <p><strong>${result}</strong></p>
        `;
      }

      // Function to start the scanner
      function startScanner() {
        Quagga.init(
          {
            inputStream: {
              name: "Live",
              type: "LiveStream",
              target: video,
            },
            decoder: {
              readers: ["code_128_reader", "ean_reader", "ean_8_reader", "code_39_reader", "code_39_vin_reader", "codabar_reader", "upc_reader", "upc_e_reader", "i2of5_reader", "2of5_reader", "code_93_reader"],
            },
          },
          function(err) {
            if (err) {
              console.error("Error initializing Quagga:", err);
              return;
            }
            Quagga.start();
          }
        );

        Quagga.onDetected(function(result) {
          const code = result.codeResult.code;
          console.log("QR code scanned:", code);
          displayScanResult(code);
          Quagga.stop();
        });
      }

      // Add click event to start scanning
      scanButton.addEventListener("click", function() {
        startScanner();
      });
    });
  </script>
</body>
</html>
